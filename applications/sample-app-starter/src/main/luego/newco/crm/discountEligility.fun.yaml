---
imports:
  - luego.text.*

exposable: true
output: 'newco.crm.Response'
inputs:
  - name: the request
    type: 'newco.crm.Request'
definition: >
  {
    let criteria1 = {
      let sum = (`the request`.products map (p => p.price)).sum;
      sum >= 200.0
    };
    let criteria2 = depending on the loyaltyLevel of `the request` {
      case None => false
      case Some(level) => level >= `LoyaltyLevel.Gold`
    };

    Response(eligibilityStatus = criteria1 and criteria2, 
      value = 100 + the value of `the request`,
      message = 'Hello ' + upper(the customerName of `the request`)) named res
  }
